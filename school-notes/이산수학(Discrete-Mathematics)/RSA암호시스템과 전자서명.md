# RSA암호시스템과 전자서명
> 공개키 시스템
>> 컴퓨터와 네트워크의 발전에 따라 암호통신을 위한 **키의 공유가 어려워지면서** 등장한 시스템
---
## RSA 공개키 암호시스템
### 키 배송 문제와 공개키 암호시스템
**대칭 암호를 사용하려면 송신자와 수신자가 `키를 사전에 공유`해야 한다.**
:question: 안전하게 키를 보내는 방법은?
- 미리 만나서 키를 공유한다면?
  - 만약 둘이 서로 멀리 떨어져 있다면?
    - 키를 이메일로 보내면?
    - 키를 전화로 알려주면?
**당연하게도 보안에 취약하다.**
키를 **직접 만나거나 안전한 방법으로 공유**해야 한다.

따라서 `Diffie-Hellman`키 교환 방법이 떠오른다.
- 1976/ `Diffie`와 `Hellman`에 의해 제안된 방법
  - **공개키 암호 개념의 첫 등장**(1976년을 현대 암호학의 시작 연도로 간주한다.)
- 제 3자가 키 교환 과정을 **외부에서 지켜보더라도 안전하게 키를 교환**할 수 있다.

또한 `공개키 암호`라는 교환 방법도 떠오른다.
- 키를 사전에 공유하지 않고도 암호 통신이 가능하게 한다.
- 1976/ `Diffie`, `Hellman`이 공개키 암호의 개념 또한 제안
- 1978/ `Rivest`, `Shamir`, `Adleman`에 의해 RSA 공개키 알고리즘이 제안됨
  - 이후 **RSA 알고리즘은 가장 많이 사용되는 공개키 알고리즘이 된다.**

### 공개키 암호시스템
1. 송신자 앨리스는 본인의 `개인키`를 만들고 `공개키`를 만든다.
2. 수신자 밥도 본인의 `개인키`를 만들고 `공개키`를 만든다.
3. 자신의 `개인키`는 안전하게 보관해야 한다. 외부에 노출해서는 안된다.
4. 자신의 `공개키`는 공개한다.
5. 송신자 앨리스는 수신자의 공개키로 평문을 암호화 하여 송신한다.
6. 수신자 앨리스는 자신의 개인키를 통해서 암호문을 복호화한다.

**사용자는 공개키와 개인키라는 특수한 관계를 만족해야 한다.**
`암호화`에 상대방의 `공개 키`를 사용하고, `복호화`에 자신의 `개인 키`를 사용한다.

:question: 공개키 암호는 안전한가?
- 대칭키 암호에서는 **두 사용자가 사용하는 키를 안전하게 관리한다.**
  - 키를 모르는 사람은 암호문으로부터 평문의 내용을 알 수 없다.
- 공개키 암호에서는 **사용자가 자신의 공개키를 공개한다.**
  - 혹시 공개된 공개키를 이용해 암호문을 복호화할 수 있지 않을까?

따라서 공개키 암호에서는 **2가지 문제점**을 해결해야 한다.
1. 공개키로 암호화한 후 개인키로 복호화하면 원래의 평문이 나오는가?
2. **공개키로부터 암호문을 복호화할 수 있는 개인키가 유도되는 것은 아닌가?**


### 모듈라 연산
:question: 모듈라 연산이란?
- 정수 a와 자연수 n에 대하여 $``a \space mod \space n"$은 $a$를 $n$으로 나눈 나머지를 의미함
- 정수 $a, b, k$와 자연수 $n$에 대하여

- $a+b \space mod \space n$은 $a+b$를 $n$으로 나눈 나머지를 의미함
- $a-b \space mod \space n$은 $a-b$를 $n$으로 나눈 나머지를 의미함
- $a \times b \space mod \space n$은 $a \times b$를 $n$으로 나눈 나머지를 의미함

#### 모듈라 연산을 사용한 페르마 정리
소수 $p, p$와 서로수인 정수 $a$에 대하여
$a^{p-1} = 1 \space mod \space p$

#### 모듈라 연산을 사용한 오일러 정리
서로 다른 수 소수 $p,q$에 대하여 $n = p \times q$라 하고 $a$를 $n$과 서로소라고 하면
$a^{(p-1)(q-1)} = 1 \space mod \space n$

#### 소인수 분해의 어려움
- 소인수분해: **자연수를 소수의 곱으로 표현하는 것**
- 72를 소인수 분해하면?
  - 2 x 2 x 2 x 3 x 3
- 3458을 소인수 분해하면?
- 112142를 소인수 분해하면?
- 20자리 정수를 소인수 분해하면?
- **숫자가 계속 커지다보면 소인수분해가 어려워진다.**

### RSA시스템
**공개키와 개인키를 생성**:
- 서로 다른 두 소수 $p,q$를 선택
- $N = p \times q, \varphi = (p-1)\times(q-1)$
- $\varphi$와 서로소인$e$를 선택
- $d = \frac{1}{e}\space mod \space \varphi$
- 개인 키 = $d$, 공개키 = $(N, e)$

**암호화**:
- 평문 $m$에 대하여 $c=m^e \space mod \space N$

**복호화**:
- 암호문 $c$에 대하여 $m=c^d \space mod \space N$


> 예제를 통해 이해를 쉽게 해보자. _[Toy EX]_

**공개키와 개인키의 생성**
- 두 소수 $p=11, q=13$
- $N = 143, \varphi = 120$
- $e = 7$
- $d = 103$
- 개인 키 = $103$, 공개 키 = $(143,7)$

**암호화**
- 평문 42에 대한 암호문
- $c=42^7 \space mod \space 143 = 81$

**복호화**
- 81을 복호화한 평문
- $81^{103} \space mod \space 143 = 42$

**두 가지 해결해야 할 점**
:question: 암호문을 복호화하면 평문이 나오는가?
- $c^d \space mod \space N = (m^e)^d \space mod \space N = m ?$
- 오일러 정리에 의하면 $c^d \space mod \space N = m$

:question: 공개키로부터 복호용 키인 개인키가 유도되지 않을까?
- $(N,e)$로부터 $d$를 유도하는 것은 $N$을 소인수분해하는것 만큼 어려울 것으로 예상됨
- 따라서 **$N$을 충분히 크게하면 `RSA`가 안전할 것으로 예상됨.**
- 보통 $N$은 **수백자리 자연수를 사용한다.**
  - **최근 연구되는 양자 컴퓨터로 계산하면 이 계산도 빨리될 수 있다.**

## 하이브리드 암호시스템
### 하이브리드 암호시스템의 필요성
**대칭키 암호 시스템과 공개키 암호 시스템의 비교**
||대칭키 암호 시스템|공개키 암호 시스템|
|:---:|:---:|:---:|
|장점|\- 속도가 빠름|\- 키의 사전공유가 불필요<br>\- 관리해야 할 키가 자신의 개인키 뿐임|
|단점|\- 키의 사전 공유가 필요<br> => **키 배송 문제**<br>\-관리해야 할 키의 개수가 많음<br> => **키 관리 문제**|\- 속도가느림|

따라서 `하이브리드 암호 시스템`의 필요성이 요구된다.
- 대칭키 암호시스템의 장점과 공개키 암호시스템의 장점을 조합한 시스템

### 하이브리드 암호시스템의 암호화/복호화
[need Image]

## 전자서명

